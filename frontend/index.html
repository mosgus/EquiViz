<!DOCTYPE html>
<html lang="en">


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EquiViz</title>
  <link rel="icon" type="image/svg+xml" href="./assets/favicon.svg">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"> <!-- Roboto font -->
  <link rel="stylesheet" href="./css/main.css">
</head>


<body>
  <header class="top-banner"> <!-- ðŸŸ¨Top Banner ðŸŸ¨-->
    <div class="banner-left">
      <button class="icon-button" type="button" aria-label="Open navigation">
          <svg aria-label="Sign In" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z"></path><path fill="#ffffff" fill-opacity=".65" fill-rule="nonzero" d="M12 23C5.925 23 1 18.075 1 12S5.925 1 12 1s11 4.925 11 11-4.925 11-11 11zm0-1c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm0-8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-1a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 7.5a.5.5 0 1 1-1 0V19a6 6 0 1 1 12 0v1.5a.5.5 0 1 1-1 0V19a5 5 0 0 0-10 0v1.5z"></path></g></svg>
        <!-- TODO: add hamburger icon asset -->
      </button>
      <span class="banner-link">EquiViz ðŸ“Š</span>
    </div>
    <div class="banner-right">
      <span class="banner-link">Sign in</span>
      <span class="profile-icon">
        <!-- TODO: add profile icon asset -->
      </span>
    </div>
  </header> <!-- ðŸŸ¨Top Banner ðŸŸ¨-->

  <main class="main-area">
    <div class="app-shell">
      <nav class="tab-bar">
        <button class="tab active" disabled>Portfolio</button>
        <button class="tab" disabled>Insights</button>
        <button class="tab" disabled>Risk</button>
        <button class="tab" disabled>Optimization</button>
        <button class="tab" disabled>Backtesting</button>
        <button class="tab" disabled>Reports</button>
      </nav>

      <section class="actions">
        <p>Create a new portfolio or use an existing one. All other tools stay locked until a portfolio is in place</p>

        <div class="button-row">
          <button class="cta port_butt" type="button" >Create Portfolio</button>
          <button class="cta upload_butt" type="button" >Upload Portfolio</button>
        </div>
      </section>
      <hr>
    </div>
<div id="createModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Create Portfolio</h2>

        <form id="createForm">
          <input type="text" id="portName" placeholder="Portfolio Name" required>
          <div class="investment-row">
            <input type="text" id="portTicker" placeholder="Ticker (e.g. AAPL)" required>
            <input class="quantity-input" id="portQty" type="number" placeholder="Qty" min="1" step="1" required>
            <input class="date-input" id="portDate" type="date" required>
          </div>

          <div id="errorMessage" style="color: #ef4444; margin-top: 10px; font-size: 0.9rem; display: none;"></div>

          <button type="submit" class="cta port_butt" style="margin-top: 20px;">Create</button>
        </form>
      </div>
    </div>
  </main>

<script>
  const modal = document.getElementById('createModal');
  const createBtn = document.querySelector('.port_butt'); // The button that OPENS modal
  const closeBtn = document.querySelector('.close');
  const createForm = document.getElementById('createForm');
  const errorMsg = document.getElementById('errorMessage');

  // Open Modal
  createBtn.addEventListener('click', () => {
    modal.classList.add('show');
    errorMsg.style.display = 'none'; // Clear errors when opening
  });

  // Close Modal
  closeBtn.addEventListener('click', () => {
    modal.classList.remove('show');
  });

  window.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.classList.remove('show');
    }
  });

  // Handle Form Submission
  createForm.addEventListener('submit', async (e) => {
    e.preventDefault(); // Stop page from reloading

    // 1. Gather data
    const payload = {
      name: document.getElementById('portName').value,
      ticker: document.getElementById('portTicker').value,
      quantity: document.getElementById('portQty').value,
      date: document.getElementById('portDate').value
    };

    try {
      // 2. Send to Python Backend
      const response = await fetch('/create-portfolio', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      const result = await response.json();

      if (response.ok) {
        // Success! Close modal and maybe alert user
        console.log("Success:", result.message);
        modal.classList.remove('show');
        createForm.reset(); // Clear form
        alert("Portfolio Created!");
      } else {
        // Error! Show message inside modal
        errorMsg.textContent = result.error;
        errorMsg.style.display = 'block';
      }

    } catch (err) {
      console.error("Connection Error:", err);
      errorMsg.textContent = "Could not connect to server.";
      errorMsg.style.display = 'block';
    }
  });
</script>
</body>
</html>ok that
